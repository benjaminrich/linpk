<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Benjamin Rich" />

<meta name="date" content="2018-03-06" />

<title>Simulating Pharmacokinetic Concentration-Time Profiles With the linpk Package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20900px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0A%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Simulating Pharmacokinetic Concentration-Time Profiles With the <code>linpk</code> Package</h1>
<h4 class="author"><em>Benjamin Rich</em></h4>
<h4 class="date"><em>2018-03-06</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>If you work in pharmacometrics, you have probably at some time or another written code to generate concentrations from a PK model by implementing the closed-form solution to a simple system of linear differential equations. The mathematical equations are readily available in many textbooks or online (for instance, <a href="http://mlxtran.lixoft.com/wp-content/uploads/sites/2/2016/02/PKPDlibrary.pdf">Mathematical Expressions of the Pharmacokinetic and Pharmacodynamic Models implemented in the Monolix</a> software by Bertrand and Mentré).</p>
<p>Each formula is specific with regard to:</p>
<ul>
<li>Dosing type: bolus, infusion (zero-order), absorption (first-order)</li>
<li>Number of doses: single, multiple, at steady state</li>
<li>Number of compartments: 1, 2, 3, …</li>
</ul>
<p>Implementing a different function for each combination you are likely to encounter is cumbersome, time consuming and error prone. Enter the <code>linpk</code> package, which conveniently uses a single function, <code>pkprofile</code>, to handle all combinations of the above.</p>
<p>Meanwhile, there are now powerful and efficient ODE solvers in R that make it easy to simulate from any PK model, including <a href="http://mrgsolve.github.io/">mrgsolve</a>, <a href="http://pkpdsim.ronkeizer.com/">PKPDsim</a>, and <a href="https://github.com/nlmixrdevelopment/RxODE">RxODE</a>. These packages are much more powerful than <code>linpk</code>, which can only solve <em>linear</em> systems of ODE. What <code>linpk</code> offers in return is convenience; most models can be simulated from using a single line of code, and there is no need to write out the model in differential equation form or perform a compilation step. In addition, <code>linpk</code> has built-in convenience functions to calculate secondary PK parameters, such as half-life, AUC or Cmax, from the simulated concentration-time profile.</p>
</div>
<div id="getting-started" class="section level2">
<h2>Getting started</h2>
<p>The first example will be deliberately simple, a 1-compartment model and a single IV bolus dose. This will serve as a starting point to see how more complex models and dosing can be accommodated.</p>
<p>First, we will create a vector of times at which to generate concentrations. In this example it will be a fine grid of equally-spaced time points from 0 to 24 hours:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.obs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="fl">0.1</span>)</code></pre></div>
<p>(A note on units: here we are assuming here that time is hours, but we are free to use any time unit we like, as long as the units for clearances and rate constants correspond. For instance, if time is in days, and volume in L, than clearance is in L/day).</p>
<p>Next, we use <code>pkprofile</code> to generate the concentrations at those times following a 100 mg IV bolus dose, and assuming a clearance of 0.5 L/h and a (central) volume of 11 L:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>There are a few things to note here. One is that the dose argument is a <code>list</code>; it can also be a <code>data.frame</code> (which is a special kind of list).</p>
<p>The object <code>y</code> is a simple object that can essentially be treated as a numeric vector of concentrations at the times <code>t.obs</code>, but it also has a few methods for convenience (for instance, it can be plotted). The result can also be converted to a <code>data.frame</code>, with columns <code>time</code> and <code>conc</code> by default:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(y)
<span class="kw">tail</span>(sim)</code></pre></div>
<pre><code>##     time     conc
## 236 23.5 3.123934
## 237 23.6 3.109766
## 238 23.7 3.095663
## 239 23.8 3.081624
## 240 23.9 3.067648
## 241 24.0 3.053736</code></pre>
</div>
<div id="dosing-type" class="section level2">
<h2>Dosing type</h2>
<p>To change from an IV bolus to an infusion, we simply add either the <code>dur</code> (duration) or <code>rate</code> of the infusion to the dose list argument. For example, to simulate the same 100 mg dose but infused over 90 minutes, we would do:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>, <span class="dt">dur=</span><span class="fl">1.5</span>))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>To simulate an oral dose (i.e., a dose administered to a depot compartment with first-order absorption), we simply specify the absorption rate constant <code>ka</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAAUVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmtrZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb////tmb/25D//7b//9v///+1+YDkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAALZUlEQVR4nO3di3KjSBJGYdlre2at3bZZy5Ks93/QFSDJlzFSUX8lZBbni5iemYg20HC6uAjB6gAIVnMvAGIjIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICkc0AqVmCugspPDXAgIEgKChIAgISBIjAJqVqvHj5fjMfqfIpODWzYBbR7ejw09Hg779XOBycEvk4A+Xo7ZbO9eD31K6uR+/mjGRQhYMQlovz7uubb3b4fzr59TETf9z58kormFGoF+j4WG5mR8DNSlJE/u5s8wEM0m0FnYjR+hoVkEug50+0dIaHpxAkr6CRKaWpiAUn+APdm0ogQ05veT0ISCBDT2t9PQVGIElHPITUKTCBFQ3rxJaAoVB8T1xSlECEiaNQXZqj4g9mS2AgQkz5mEDC0hIE7rDfkPqNCMScjGYgIiIRvuAyo5X/Zk5S0qoAPDUHHeAyq/vUmoqOUFxJ6sKOcBWW1pEiploQGRUCm+AzLdyCRUwoID4mCohEUHdGAYki09IG4aErkOaLINS0HZCKifEwllIqDzvNiTZSGgGedXAwL6NkMSGstzQHNsTfZkIxGQn/mGREC/zZhhKJnjgObdhiSUhoDczj8GArqyAOzJbvMbkI9tR0I3ENAtDENXEVACEhpGQEk4HBriNiB/28vfEnlAQOkYhn5hFFBz/3bYPa1W3fsysibndFOR0A8ZAXWvMDj6/h6eb7p+/no9vbcna75uNxTD0DcZATVXyul1r5lrHtv/zH5bj+etREKfxgc0+BLCT+24c3pPT+77wpxvIoahs5yAht7A86kdfTbSCOR/+5BQZ3xAHy+PN3/zfn3/9uWtcxnzjbB1OCs7ZB0DbQdfAvbFtt9RDbZWQ0CtKMtpJmcXtrp5FibPN852Wfow5PRCYqxtsuSICKiQeEtcRk5A7SXm4WvMReYbcHMsdBjKOohur/BsUg6ls+cbdFMssKGc0/j+QuLQFZ4S8w28GZaWUP6FxK3hWVjojbCsfRkjkInwf4BkPo+B4q//xQxDPs/C6lj3i2jI5XWgetZ7/QMRAZmrOyECmkDNw9DIgPbr5wk+TK1wdVe7L2MEmk6VDWVcSPxPf/5leCGxwvV8Ul9C+QFtCChHbfuysQE1n7fF37y3Pnu+Va3hX9TUUP4IZDffetbusGoGIo8H0XWs2duqaCgjoPN5vNkxUAWrNVX8hDICah7eN4+H3ZPZh6nhV+oY0YehnPuBng/bh3fD2zlir9HxQh8P5d1Qtvv7rfvHZr5x12a+sBHl3VDWnokRUGkhG8o4BmqvIDbP7MIsxBuIck7jm8f2TEw6CSOgYbEacngdKNLqMxJoIMq/qd5svlFWnbEgDeV/rcdsviHW2yQiDEQ538rQjn5uztf9OpuU94ZyRiDjOxJ9r7AZuB6IOIiOwW1DDu9IdLqmZudzIPJ3R6LDleSHv4b83ZHobQ1542wg8ndHoqe145WjhvwdRLtZNb4lPa59iuUY/xsT3pWhzNfBSolj/oZy7ki0vZA49xqJZuaBKO+ORMv5EtB4MzZk+lnYlfumB+dLP3nmGohyPo2/+a6My6cdw0dKBGRgjuPqnA9Tbz/crn8KHiPQHCaOyOjD1P26veH1nwF9jkzyAmHYhA2ZXQdq7l4ZgWY01e7M7kLiZvVMQDObIKKcgI47sYf35ubJ/O7pXwQ0P+OGcg6i7143D+8Jl4M+XoYPtwloQpYfe+TdVN9+J8zmdg76MWPTUN6FxDYgmxvKCMiSwVCUPwI1Jt9MJSB7RRvKPgYyelcGAU2i3EiUeRZm9q4MAppOkYi83VBGQNOShyICglRRTkDt4fNWu6eegNzJjCjnjsTu9Gu/vnlXR8Z86WdWGUNR/g1lJteBCGh+4y4W5V0HaplciSYgL1IbyiitvwK0e7L4YiEBOZI0EuUMVYbvTCUgb27t0JydxhOQT8MVERBS/VpRRkCW30wloGhyrgPZfTOVfsLx9c1UAgrH9Jupo+dLQOGYfDM1e74EFI7NN1Nz50tA4Rh9MzVzvgQUjq/rQAQUDgFB4uuzMAIKJ+sgur0QZPKtDAIKR7gfyOB7YQQUjq87EgkoHEYgSDgGgsTVWRj9xOPqOhABxUNAkIwOqP8wXvxOBgFVY2xA/fN7P/9ddL4EFM/YgC6PlRJvTCSgSowM6HwR6GByHYiA4hkZ0Jf7WQ2uRBNQPKMD+hyBCAgZx0CXG6KvPmRzs1r1V6qHMiOgSowN6PL2giuvMThmc/d6eoAQAVVu9HWg06PJNteeUNYfan+8XHkcOQFVIufT+PaO+qtf7Tkfah/3cj8Cuv66JwKKx+SjjMvJfvPICFQ5m8/Cztns16NeeUlA8Rh9mHq+W+jjhYDq5unTePoJiIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEkcB0U9EBAQJAUFCQJAQECQEBAkBQUJAkBAQJAQECQFBQkCQEBAkfgKin5AICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEjcBEQ/MREQJAQEiVFA/RtZVkMvOiCgatgEdHkZ1HborVAEVAmTgBJezUtAlTAJaPjVvMPvCyOgmNyMQIjJ6hjoNASlHwMhJqOzsP2631ENvtmZgCrh5joQYiIgSAgIEgKCZLaAUImZApps+tGmG2+Bncw/2nojIGfzj7beCMjZ/KOtNwJyNv9o642AnM0/2nojIGfzj7beCMjZ/KOtNwJyNv9o642Ags0fwREQJAQECQFBQkCQEBAkBAQJAUFCQJAQECQEBAkBQUJAkJgGtF2t7l7LT7b/hv5j6cnu/u4eWVN+ofsJF17q7mFx3SMujNZyIsuAtsc/19bgz7b7y2J97dfdM4/KL/RpwmWX+uPluIybtkertZzIMKD+cUJN8ZHi59OtCk20f/Jj+YU+TbjwUu+e2iftbO7fzNZyIsOALn/G0hPeGKyt7eq528LFF/o8YZulvns1W8uJLAPqxmyD4aL593n3X1QfkMFC91OzWOrm/s1sLScyDKjfMZffPe/X7fOtmuIFdRvBYqG7CVssdfugOKu1nCpgQKepF/87ZxvQP/6zwHTPx9CVBmQ7uPb7/pKMd2GdkkvdP6iy4l2Y7eFd+XN5m4Pow/eAyi316anvFR9EW51g9qvMaBdmsdBfyiy31Ocn5lZ8Gm92iatbW0YH0RYLfToLK7rUu6fzlOq9kNj+LbG5yN4cT4hLHwFdRofyC32acNGl3vTPEWuX1Gotp+HDVEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAbuifznt0/791+e/jx0dACWyeK1wHAkpAQMMIKEEf0P64C9s9/fe4S3vePfVPatmYPC42FAJK8DWg7gHx92/dQ+U2x//5fNLTMhFQgq8BPR/Ov/zZr9t25nu+pQsElOBrQH8Ol1/6B8uVf1xsKASUYCig0wk+AeG6qyPQwhFQgoGA9lxZJKAkAwF1Z2GHZtnjEAElGAqouw607JMwAoKGgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAgSAoKEgCAhIEgICBICgoSAICEgSAgIEgKChIAgISBICAiS/wO3NKs1Y9MddwAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>The function recognizes by the presence of this parameter that a first-order absorption is required. Note that if both <code>dur</code> (or <code>rate</code>) and <code>ka</code> are specified, then the function will deduce that the dose is infused into the depot compartment.</p>
<p>An oral dose may have an associated time <code>lag</code> and bioavailability (<code>f</code>). These parameters can be added to the dose list argument as necessary:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>, <span class="dt">lag=</span><span class="fl">0.4</span>, <span class="dt">f=</span><span class="fl">0.6</span>))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-doses" class="section level2">
<h2>Multiple doses</h2>
<p>There are two ways to specify multiple doses to <code>pkprofile</code>. The first is to add dose times to the dose list argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">t.dose=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>), <span class="dt">amt=</span><span class="dv">100</span>))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>In this example, we have simulated two doses, one given at time zero, and the second at 12 hours. We can also specify different amounts for each dose:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">t.dose=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>), <span class="dt">amt=</span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">50</span>)))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The second way to specify multiple doses is to use the <code>addl</code> argument for <em>additional</em> doses, along with the <em>inter-dose interval</em> <code>ii</code>. Thus, to simulate regular doses of 100 mg every 12 hours for 5 days, we could do the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.obs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>*<span class="dv">24</span>, <span class="fl">0.5</span>)
y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>, <span class="dt">addl=</span><span class="dv">9</span>, <span class="dt">ii=</span><span class="dv">12</span>))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>A different way of achieving the same, without using <code>addl</code>, is to use <code>seq()</code> to specify a vector of dose times:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">t.dose=</span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">9</span>*<span class="dv">12</span>, <span class="dv">12</span>), <span class="dt">amt=</span><span class="dv">100</span>))
<span class="kw">plot</span>(y, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>We can, of course, mix the different options as well. To specify 100 mg doses every 24 hours, with an extra dose of 50 mg at 14 hours on day 3, we can do the following:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>,
    <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">t.dose=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">24</span>*<span class="dv">2</span> +<span class="st"> </span><span class="dv">14</span>), <span class="dt">amt=</span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">50</span>), <span class="dt">addl=</span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">0</span>), <span class="dt">ii=</span><span class="dv">24</span>))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAGACAMAAAByRC0tAAAATlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtrZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb////tmb/25D//7b//9v///8MSX8PAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQdUlEQVR4nO2dgVbbPBJG3QL7l13YZpsGyPu/6MZxEiCJLc18GltR7j2nFIhmZCkXWZYdu9sCCHRLbwDcNggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEggEEhaB3p9/7b5uuq77+Sdqe+DGMAu0fvjbf/cStkVwU1gFOqiz1+haOmiEKIHenvYCbUZ2YkypGiFMoNQIZEgHFRMkUD+2PW6P02kxHVRMiEDbvUM/fu8OxEb8QaBWiBJo5nSwFDMLZJ+8Q90wAoEEAoXT9mgbeBQ2cPfrQF3bjY0ZgT5eUyfBWu7T73TbplsbtAv7eH0sme6G6U5f2iRqDrTpps+iNtyl3+m+fG0RJtHBIJC14CLp6gWBrAUXSVcvCGQtuEi6eum+/dceCBQMAlkLLpKuWrqz/5sDgWLpLr5pDASKBYHMBRdJVy3dle+aAoFiQSBzwUXSVQsCmQsukq5auqvfNgQCxYJA5oKLpKsWBDIXXCRdtXQj3zcDAsWCQOaCi6Srlm70h0ZAoFC6iZ+MmSr9cAcChdJN/mjMVGWfIVAoxQSq9tp8BAoFgewFF0lXK+fNdDe72itjESgUBLIXXCRdrVw009vuaq+MRaBQSglU75WxCBQKAtkLLpKuVi6b6Wt4vVfGIlAoCGQvuEi6WrnSTFfLESg4XaVca6UmUHUdh0CRXG2lo+kVX5aGQJEECFRbzyFQJAjkKLhIukq53kp72yu+LA2BxtGv4UIgR8FF0oWg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" style="display: block; margin: auto;" /></p>
</div>
<div id="doses-at-steady-state" class="section level2">
<h2>Doses at steady state</h2>
<p>One can specify a dose given at steady state by adding <code>ss=T</code> or <code>ss=1</code> to the dose list argument. Going back to a previous examples, we had regular regular doses of 100 mg every 12 hours for 5 days. To see that steady state has been reached after 5 days, let us overlay the steady state profile in green:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.obs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>*<span class="dv">24</span>, <span class="fl">0.5</span>)
y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>, <span class="dt">addl=</span><span class="dv">9</span>, <span class="dt">ii=</span><span class="dv">12</span>))
<span class="kw">plot</span>(y)
yss &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>, <span class="dt">addl=</span><span class="dv">9</span>, <span class="dt">ii=</span><span class="dv">12</span>, <span class="dt">ss=</span>T))
<span class="kw">lines</span>(yss, <span class="dt">col=</span><span class="st">&quot;green3&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Steady state&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;green3&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="number-of-compartments" class="section level2">
<h2>Number of compartments</h2>
<p>The <code>pkprofile</code> function makes it easy to specify models with 1, 2, 3 or more compartments (practically speaking, you will never go over 3 compartments, but the function is not restricted). The way to specify the number of compartments is to include the parameters that are appropriate to the model. The mandatory parameters are <code>cl</code> and <code>vc</code>. For a 2-compartment model, add <code>q</code> and <code>vp</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.obs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">24</span>, <span class="fl">0.1</span>)
y2 &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">q=</span><span class="dv">2</span>, <span class="dt">vp=</span><span class="dv">30</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>))</code></pre></div>
<p>For a 3 (or more) compartments, you can specify <code>q</code> and <code>vp</code> as vectors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y3 &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">q=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>), <span class="dt">vp=</span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">3</span>), <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>))
<span class="kw">plot</span>(y2)
<span class="kw">lines</span>(y3, <span class="dt">col=</span><span class="st">&quot;green3&quot;</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;2-Compartment&quot;</span>, <span class="st">&quot;3-Compartment&quot;</span>), <span class="dt">col=</span><span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;green3&quot;</span>), <span class="dt">lty=</span><span class="dv">1</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="secondary-parameters" class="section level2">
<h2>Secondary parameters</h2>
<div id="half-lives" class="section level3">
<h3>Half-lives</h3>
<p><code>linpk</code> makes it quite easy to access some secondary parameters from the PK model and simulation. The half-lives of the model can be obtained directly using the <code>halflife()</code> function. For instance for the 3-compartment model with first-order absorption in the previous section:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">q=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="fl">0.3</span>), <span class="dt">vp=</span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">3</span>), <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>))
<span class="kw">halflife</span>(y)</code></pre></div>
<pre><code>##       HL.1       HL.2       HL.3       HL.a 
##  2.1946882  7.2720612 68.8588820  0.5331901</code></pre>
<p>There are 4 components: the <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> half-lives, as well as the absorption half-life.</p>
<p>Note that computing the half-life doesn’t require any doses or sampling. For example, this 2-compartment model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">halflife</span>(<span class="kw">pkprofile</span>(<span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">q=</span><span class="dv">2</span>, <span class="dt">vp=</span><span class="dv">30</span>))</code></pre></div>
<pre><code>##      HL.1      HL.2 
##  2.447202 64.788075</code></pre>
</div>
<div id="other-secondary-parameters-cmin-cmax-auc" class="section level3">
<h3>Other secondary parameters (Cmin, Cmax, AUC, …)</h3>
<p>Other secondary parameters are accessed using the <code>secondary()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">secondary</span>(y)</code></pre></div>
<pre><code>##   From To   N       Ctrough          Cmin     Cmax     Cave      AUC Tmin Tmax
## 1    0 24 241 -5.167584e-15 -5.167584e-15 6.170103 2.512857 60.30857    0  1.6</code></pre>
<p><strong>Note that these secondary parameters are computed based on the simulated profile, so the time points specified in <code>t.obs</code> are important and relevant.</strong> This function optionally takes arguments <code>From</code> and <code>To</code> to specify intervals over which the parameters are computed. Looking at an example with multiple dosing, we observe that when not specified, the default is to compute secondary parameters over the intervals defined by the dose times:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.obs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>*<span class="dv">24</span>, <span class="fl">0.1</span>)
y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.5</span>, <span class="dt">vc=</span><span class="dv">11</span>, <span class="dt">q=</span><span class="dv">2</span>, <span class="dt">vp=</span><span class="dv">30</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span><span class="kw">list</span>(<span class="dt">amt=</span><span class="dv">100</span>, <span class="dt">addl=</span><span class="dv">5</span>, <span class="dt">ii=</span><span class="dv">24</span>))
<span class="kw">plot</span>(y)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">secondary</span>(y)</code></pre></div>
<pre><code>##   From  To   N       Ctrough          Cmin      Cmax     Cave       AUC Tmin Tmax
## 1    0  24 241 -2.260818e-15 -2.260818e-15  6.335438 2.660562  63.85349    0  1.7
## 2   24  48 241  1.466404e+00  1.466404e+00  7.771659 3.946255  94.71012   24 25.7
## 3   48  72 241  2.592773e+00  2.592773e+00  8.877722 4.939629 118.55110   48 49.7
## 4   72  96 241  3.464063e+00  3.464063e+00  9.733716 5.708050 136.99319   72 73.6
## 5   96 120 241  4.138048e+00  4.138048e+00 10.396262 6.302459 151.25902   96 97.6</code></pre>
<p>But we can easily ask for the AUC from 0 to 12 hours, 0 to 48 hours, and 48 to 128 hours, for instance:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">secondary</span>(y, <span class="dt">From=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">48</span>), <span class="dt">To=</span><span class="kw">c</span>(<span class="dv">12</span>, <span class="dv">48</span>, <span class="dv">128</span>))</code></pre></div>
<pre><code>##   From  To   N       Ctrough          Cmin      Cmax     Cave       AUC Tmin Tmax
## 1    0  12 121 -2.260818e-15 -2.260818e-15  6.335438 3.679664  44.15597    0  1.7
## 2    0  48 481 -2.260818e-15 -2.260818e-15  7.771659 3.303409 158.56361    0 25.7
## 3   48 120 721  2.592773e+00  2.592773e+00 10.396262 5.650046 406.80331   48 97.6</code></pre>
</div>
</div>
<div id="combining-iv-infusion-with-first-order-absorption" class="section level2">
<h2>Combining IV infusion with first-order absorption</h2>
<p>As a last example, let us consider a slightly more complex scenario in which we simulate an 150 mg IV dose at time zero, followed by daily subcutaneous 10 mg doses (first-order absorption) on days 8 to 20 (here we will assume that the unit of time is days so clearance is in L/day). To do so, it is necessary to know that we can specify the compartment that a particular dose is administered to using the <code>cmt</code> element of the dosing list argument. The central compartment is always associated with the number 1, while specifying <code>cmt=0</code> indicates that the dose goes to the default dosing compartment, which is the depot compartment in the presence of <code>ka</code> (first-order absorption), and the central compartment otherwise. For no particular reason other than to illustrate that it can be done, we will also specify the dose list as an external <code>data.frame</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.obs &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="fl">0.1</span>)
doses &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">t.dose=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>), <span class="dt">amt=</span><span class="kw">c</span>(<span class="dv">150</span>, <span class="dv">10</span>), <span class="dt">addl=</span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">12</span>), <span class="dt">ii=</span><span class="dv">1</span>, <span class="dt">cmt=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="dt">dur=</span><span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">24</span>, <span class="dv">0</span>))
doses</code></pre></div>
<pre><code>##   t.dose amt addl ii cmt        dur
## 1      0 150    0  1   1 0.04166667
## 2      7  10   12  1   0 0.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">pkprofile</span>(t.obs, <span class="dt">cl=</span><span class="fl">0.8</span>, <span class="dt">vc=</span><span class="dv">6</span>, <span class="dt">q=</span><span class="fl">0.09</span>, <span class="dt">vp=</span><span class="fl">4.5</span>, <span class="dt">ka=</span><span class="fl">1.3</span>, <span class="dt">dose=</span>doses)
<span class="kw">plot</span>(y, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">main=</span><span class="st">&quot;150 mg IV at time zero, 10 mg SC QD on days 8 to 20&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;Time (days)&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
</div>
<div id="limitations" class="section level2">
<h2>Limitations</h2>
<p>Compared to more general ODE solvers (<a href="http://mrgsolve.github.io/">mrgsolve</a>, <a href="http://pkpdsim.ronkeizer.com/">PKPDsim</a>, <a href="https://github.com/nlmixrdevelopment/RxODE">RxODE</a>), this package has some limitations, the most obvious being that it can only simulate from <em>linear</em> PK models. This means that it cannot be used to simulate from most PD models, for instance. Another limitation is that parameters must be fixed value, they cannot change over time.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
